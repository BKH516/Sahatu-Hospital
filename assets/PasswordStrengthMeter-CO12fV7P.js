import{j as n}from"./index-x3QSyaHy.js";const c=class c{static checkStrength(e){const t=[];let r=0;e.length>=8?(r++,e.length>=12&&r++):t.push("يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل"),/[A-Z]/.test(e)?r++:t.push("يُفضل أن تحتوي على حرف كبير (A-Z)"),/[a-z]/.test(e)?r++:t.push("يجب أن تحتوي على حرف صغير (a-z)"),/\d/.test(e)?r++:t.push("يجب أن تحتوي على رقم (0-9)"),(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)||/[A-Z]/.test(e))&&r++;const a=e.toLowerCase();return this.commonPasswords.some(l=>a.includes(l))&&(r=Math.max(0,r-1),t.push("كلمة المرور شائعة، حاول استخدام كلمة أكثر تعقيداً")),/(.)\1{3,}/.test(e)&&t.push("تجنب تكرار نفس الحرف أكثر من 3 مرات"),{score:r,feedback:t,isStrong:r>=4&&e.length>=8}}static isValid(e){return this.checkStrength(e).score>=3&&e.length>=8}static getStrengthLabel(e){return e<=1?"ضعيفة جداً":e<=2?"ضعيفة":e<=3?"مقبولة":e<=4?"جيدة":e<=5?"قوية":"قوية جداً"}static generateStrongPassword(e=16){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",a="0123456789",l="!@#$%^&*()_+-=[]{}|;:,.<>?",o=t+r+a+l;let s="";s+=t[Math.floor(Math.random()*t.length)],s+=r[Math.floor(Math.random()*r.length)],s+=a[Math.floor(Math.random()*a.length)],s+=l[Math.floor(Math.random()*l.length)];for(let i=s.length;i<e;i++)s+=o[Math.floor(Math.random()*o.length)];return s.split("").sort(()=>Math.random()-.5).join("")}};c.commonPasswords=["password","123456","12345678","qwerty","abc123","password123","111111","123123","admin","letmein","welcome","1234567890","password1","qwerty123","مرحبا","كلمةالمرور","ادمن"];let g=c;const m=({password:d})=>{if(!d)return null;const{score:e,feedback:t,isStrong:r}=g.checkStrength(d),a=e/6*100,l=()=>e<=1?"bg-red-500":e<=2?"bg-orange-500":e<=3?"bg-yellow-500":e<=4?"bg-blue-500":"bg-green-500",o=()=>e<=1?"text-red-600 dark:text-red-400":e<=2?"text-orange-600 dark:text-orange-400":e<=3?"text-yellow-600 dark:text-yellow-400":e<=4?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400",s=g.getStrengthLabel(e);return n.jsxs("div",{className:"mt-1 space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full ${l()}`,style:{transform:`scaleX(${a/100})`,transformOrigin:"left",transition:"transform 300ms ease",willChange:"transform"}})}),n.jsx("span",{className:`text-[10px] sm:text-xs font-medium ${o()} whitespace-nowrap`,children:s})]}),t.length>0&&!r&&n.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-md px-1.5 py-1 border border-orange-200 dark:border-orange-800",children:n.jsxs("ul",{className:"text-[10px] sm:text-xs text-gray-700 dark:text-gray-300 space-y-0.5",children:[t.slice(0,2).map((i,h)=>n.jsxs("li",{className:"flex items-start gap-1",children:[n.jsx("span",{className:"text-orange-500 text-[8px] mt-0.5",children:"●"}),n.jsx("span",{className:"leading-tight",children:i})]},h)),t.length>2&&n.jsxs("li",{className:"text-[9px] text-orange-600 dark:text-orange-400 mt-0.5",children:["+",t.length-2," نصيحة أخرى"]})]})}),r&&n.jsxs("div",{className:"flex items-center gap-1 text-[10px] sm:text-xs text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 rounded-md px-1.5 py-0.5 border border-green-200 dark:border-green-800",children:[n.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),n.jsx("span",{className:"font-medium",children:"كلمة مرور قوية!"})]})]})};export{m as P,g as a};
