import{u as re,j as e,T as te,A as R,c as W,r as m,s as b,g as ae,d as le,e as de,h as ne,i as ie,k as ce,m as oe,n as xe,o as me,p as he}from"./index-C4Nck0w6.js";import{M as ge,S as ue,e as pe,f as be,g as fe,h as z,i as M,j as S,D as je,U as F,H as ye,C as v,a as _,b as L,c as I,d as k,B as y,k as $,X as P,A as B,P as Q,l as U,I as O,E as ve}from"./Input-JtWgKl1r.js";const ke=()=>{const{theme:s,toggleTheme:t}=re();return e.jsx("button",{onClick:t,className:"flex items-center justify-center p-2 rounded-lg transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300","aria-label":s==="light"?"تفعيل الوضع الليلي":"تفعيل الوضع النهاري",title:s==="light"?"الوضع الليلي":"الوضع النهاري",children:s==="light"?e.jsx(ge,{className:"w-5 h-5"}):e.jsx(ue,{className:"w-5 h-5"})})},Ne=({onLogout:s,onMenuClick:t,userFullName:l,activeTab:g,onTabChange:x})=>{const o=[{key:"overview",label:"الرئيسية",icon:"🏠"},{key:"services",label:"الخدمات",icon:"🏥"},{key:"schedule",label:"الجدول",icon:"📅"},{key:"reservations",label:"الحجوزات",icon:"⏳"},{key:"history",label:"السجل",icon:"📜"},{key:"profile",label:"الملف الشخصي",icon:"👤"}],a=i=>{x&&x(i)};return e.jsx("header",{className:"w-full h-16 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-b border-gray-200/50 dark:border-gray-700/50 shadow-sm z-30 fixed top-0 right-0 left-0 transition-colors duration-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full",children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"lg:hidden flex items-center justify-center text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg p-2 transition-all duration-200",onClick:t,"aria-label":"فتح القائمة الجانبية",children:e.jsx(pe,{size:24})}),e.jsx("div",{children:e.jsx("img",{src:"/Sahatu-Hospital/assets/sihatelogo.png",alt:"صحتي لوجو",className:"h-10 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})}),l&&e.jsxs("div",{className:"hidden md:flex items-center gap-2 px-3 py-2 text-gray-700 dark:text-gray-300",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.75 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),e.jsx("span",{className:"text-sm font-medium",children:l})]})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-1",children:o.map(i=>e.jsxs("button",{onClick:()=>a(i.key),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap min-w-fit ${g===i.key?"bg-teal-600 dark:bg-teal-500 text-white shadow-lg shadow-teal-500/25":"text-gray-600 dark:text-gray-300 hover:text-teal-600 dark:hover:text-teal-400 hover:bg-teal-50 dark:hover:bg-gray-800"}`,children:[e.jsx("span",{className:"text-base",children:i.icon}),e.jsx("span",{children:i.label})]},i.key))}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{}),e.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-3 py-2 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200 font-medium",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6A2.25 2.25 0 005.25 5.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 15l3-3m0 0l-3-3m3 3H9"})]}),e.jsx("span",{className:"hidden sm:inline",children:"خروج"})]})]})})]})})})},we=({isOpen:s,onClose:t,activeTab:l,onTabChange:g})=>{const x=[{id:"overview",label:"الرئيسية",icon:fe,activeColor:"from-teal-600 to-blue-600",hoverColor:"hover:bg-teal-50"},{id:"services",label:"الخدمات",icon:z,activeColor:"from-teal-600 to-blue-600",hoverColor:"hover:bg-teal-50"},{id:"schedule",label:"جدول العمل",icon:M,activeColor:"from-teal-600 to-blue-600",hoverColor:"hover:bg-teal-50"},{id:"reservations",label:"الحجوزات",icon:S,activeColor:"from-purple-600 to-indigo-600",hoverColor:"hover:bg-purple-50"},{id:"history",label:"سجل الحجوزات",icon:je,activeColor:"from-indigo-600 to-purple-600",hoverColor:"hover:bg-indigo-50"},{id:"profile",label:"الملف الشخصي",icon:F,activeColor:"from-teal-600 to-blue-600",hoverColor:"hover:bg-teal-50"}];return e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 z-40 lg:hidden",onClick:t}),e.jsx("div",{className:`
        fixed top-0 right-0 h-full w-64 z-50 transform transition-transform duration-300 ease-in-out lg:hidden
        ${s?"translate-x-0":"translate-x-full"}
      `,children:e.jsxs("div",{className:"h-full w-full relative bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 border-l border-gray-200 dark:border-gray-700 shadow-lg transition-colors duration-200",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 p-2 rounded-lg transition-colors duration-200 ease-in-out text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white",children:e.jsx(be,{className:"w-6 h-6"})}),e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 pt-16",children:e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"ص"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:"منصة صحتي"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"لوحة التحكم"})]})]})}),e.jsx("nav",{className:"mt-6 px-4",children:e.jsx("ul",{className:"space-y-2",children:x.map(o=>{const a=o.icon,i=l===o.id;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>{g(o.id),t()},className:`
                        w-full flex items-center space-x-3 space-x-reverse px-4 py-3 rounded-lg
                        transition-all duration-200 ease-in-out text-right
                        ${i?`bg-gradient-to-l ${o.activeColor} text-white shadow-lg`:`text-gray-600 dark:text-gray-300 ${o.hoverColor} dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white`}
                      `,children:[e.jsx(a,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:o.label})]})},o.id)})})})]})})]})};let X=!0;const Ce=s=>new Promise(t=>setTimeout(t,s));async function V(s,t={},l){var a,i,u;const g=te.getToken(),x=new Headers(t.headers||{});x.set("Accept","application/json"),t.body instanceof FormData?x.delete("Content-Type"):t.body&&!x.has("Content-Type")&&x.set("Content-Type","application/json"),g&&x.set("Authorization",`Bearer ${g}`);let o;for(let h=0;h<=R.MAX_RETRIES;h++)try{const c=new AbortController,j=setTimeout(()=>c.abort(),R.REQUEST_TIMEOUT),d=await fetch(`${R.BASE_URL}${s}`,{...t,headers:x,signal:c.signal});if(clearTimeout(j),X=!0,!d.ok){const r=await d.json().catch(()=>({message:`HTTP ${d.status}`}));throw new Error(r.message||"API error")}const w=d.headers.get("content-type");return d.status===204||!w||!w.includes("application/json")?null:await d.json()}catch(c){if(o=c,(a=c.message)!=null&&a.includes("401")||(i=c.message)!=null&&i.includes("HTTP 4")&&!((u=c.message)!=null&&u.includes("429")))break;if(h<R.MAX_RETRIES){const j=R.RETRY_DELAY*Math.pow(2,h);console.log(`Retry attempt ${h+1}/${R.MAX_RETRIES} for ${s} after ${j}ms`),await Ce(j)}}if(X=!1,l!==void 0)return console.warn(`API call failed for ${s} after ${R.MAX_RETRIES} retries, using fallback`,o),l;throw o}const Se={workDays:{total:0,days:[]},services:{total:0,averagePrice:0,totalCapacity:0},reservations:{total:0,pending:0,confirmed:0,cancelled:0,completed:0,today:0,thisWeek:0,thisMonth:0,revenue:0}},G=async()=>(await V(W.HOSPITAL_RESERVATIONS,{},[])||[]).map(t=>({...t,user_name:t.user_name==="N/A"?"غير متوفر":t.user_name,service_name:t.service_name==="N/A"?"غير متوفر":t.service_name})),De=async s=>(await G()).filter(l=>l.status===s),_e=async()=>De("pending"),Le=async s=>{await K(s,"confirmed")},Te=async s=>{await K(s,"cancelled")},Ie=async()=>await V(W.HOSPITAL_SERVICES,{},[])||[],Ee=async()=>await V(W.HOSPITAL_WORK_SCHEDULES,{},[])||[],K=async(s,t)=>{try{return await V(`${W.HOSPITAL_RESERVATIONS_UPDATE_STATUS(s)}?status=${encodeURIComponent(t)}`,{method:"PATCH"}),!0}catch(l){throw console.error("Error updating reservation status:",l),l}},Re=async()=>{try{const[s,t,l]=await Promise.all([G(),Ie(),Ee()]),g=new Date().toISOString().split("T")[0],x=new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],o=new Date(new Date().getFullYear(),new Date().getMonth()+1,0).toISOString().split("T")[0],a=new Date;a.setDate(a.getDate()-a.getDay());const i=a.toISOString().split("T")[0],u=s.filter(f=>f.start_date===g),h=s.filter(f=>f.start_date>=i),c=s.filter(f=>f.start_date>=x&&f.start_date<=o),j=s.filter(f=>f.status==="pending"),d=s.filter(f=>f.status==="confirmed"),w=s.filter(f=>f.status==="completed"),r=s.filter(f=>f.status==="cancelled"),N=s.reduce((f,E)=>f+(E.price||0),0),p=t.length>0?t.reduce((f,E)=>f+(parseFloat(E.price)||0),0)/t.length:0,C=t.reduce((f,E)=>f+(E.capacity||0),0),T=l.map(f=>f.day_of_week);return{workDays:{total:l.length,days:T},services:{total:t.length,averagePrice:Math.round(p*100)/100,totalCapacity:C},reservations:{total:s.length,pending:j.length,confirmed:d.length,cancelled:r.length,completed:w.length,today:u.length,thisWeek:h.length,thisMonth:c.length,revenue:N}}}catch(s){return console.error("Error getting dashboard stats:",s),Se}},Y=({onNavigate:s,userFullName:t})=>{const[l,g]=m.useState(null),[x,o]=m.useState(!0);m.useEffect(()=>{(async()=>{try{o(!0);const c=await Re();g(c)}catch(c){console.error("Error loading dashboard stats:",c)}finally{o(!1)}})()},[]);const a=()=>{const h=new Date().getHours();return h<12?"صباح الخير":(h<17,"مساء الخير")},i=()=>{const h=new Date,c={weekday:"long",year:"numeric",month:"long",day:"numeric"};return h.toLocaleDateString("ar-EG",c)},u=()=>t&&t!==""?t:"مستشفى صحتي";return e.jsxs("div",{className:"space-y-4 md:space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-teal-500 via-blue-600 to-indigo-700 rounded-xl sm:rounded-2xl md:rounded-3xl p-3 sm:p-4 md:p-6 lg:p-8 text-white shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 md:w-32 md:h-32 bg-white/10 rounded-full -translate-y-10 md:-translate-y-16 translate-x-10 md:translate-x-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 md:w-24 md:h-24 bg-white/10 rounded-full translate-y-8 md:translate-y-12 -translate-x-8 md:-translate-x-12"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4 md:gap-6",children:[e.jsxs("div",{className:"text-center lg:text-right flex-1 w-full",children:[e.jsxs("div",{className:"mb-2 sm:mb-3 md:mb-4",children:[e.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl font-bold mb-1 md:mb-2 leading-tight",children:[a(),"، ",u()]}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl text-teal-100 mb-1 sm:mb-2 md:mb-3",children:"مرحباً بك في لوحة التحكم الخاصة بالمستشفى"}),e.jsx("p",{className:"text-[10px] xs:text-xs md:text-sm text-teal-200 opacity-90",children:i()})]}),e.jsxs("div",{className:"flex flex-wrap justify-center lg:justify-start gap-1.5 sm:gap-2 md:gap-3",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-md sm:rounded-lg md:rounded-xl px-1.5 py-0.5 sm:px-2 sm:py-1 md:px-4 md:py-2 border border-white/30",children:[e.jsx("span",{className:"text-sm sm:text-base md:text-lg",children:"🏥"}),e.jsx("span",{className:"mr-1 md:mr-2 font-medium text-[10px] sm:text-xs md:text-sm",children:"مستشفى صحتي"})]}),e.jsx("div",{className:"text-center group cursor-pointer",onClick:()=>s("services"),children:e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-md sm:rounded-lg md:rounded-xl px-1.5 py-0.5 sm:px-2 sm:py-1 md:px-4 md:py-2 border border-white/30 hover:bg-white/30 transition-colors",children:[e.jsx("span",{className:"text-sm sm:text-base md:text-lg",children:"📱"}),e.jsx("span",{className:"mr-1 md:mr-2 font-medium text-[10px] sm:text-xs md:text-sm",children:"إدارة ذكية"})]})}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-md sm:rounded-lg md:rounded-xl px-1.5 py-0.5 sm:px-2 sm:py-1 md:px-4 md:py-2 border border-white/30",children:[e.jsx("span",{className:"text-sm sm:text-base md:text-lg",children:"⚡"}),e.jsx("span",{className:"mr-1 md:mr-2 font-medium text-[10px] sm:text-xs md:text-sm",children:"سرعة في الأداء"})]})]})]}),e.jsx("div",{className:"flex-shrink-0 hidden sm:block",children:e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 lg:w-32 lg:h-32 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center border-4 border-white/30 shadow-2xl",children:e.jsx(ye,{className:"w-10 h-10 md:w-12 md:h-12 lg:w-16 lg:h-16 text-white"})})})]})})]}),x&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"}),e.jsx("p",{className:"mr-4 text-gray-600 dark:text-gray-300",children:"جاري تحميل الإحصائيات..."})]}),!x&&l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-8",children:e.jsxs(v,{className:"hover:shadow-lg transition-shadow duration-300 border-r-4 border-r-green-500",children:[e.jsxs(_,{className:"pb-3 md:pb-4",children:[e.jsxs(L,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(M,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600"}),"إحصائيات جدول أيام العمل"]}),e.jsx(I,{className:"text-xs md:text-sm",children:"الأيام المتاحة للعمل في المستشفى"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20 rounded-lg md:rounded-xl border border-green-200 dark:border-green-700",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-green-700 dark:text-green-400 font-medium mb-0.5 sm:mb-1",children:"إجمالي أيام العمل"}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-green-900 dark:text-green-100",children:l.workDays.total})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-green-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(M,{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 text-green-600"})})]})}),e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-900/30 dark:to-emerald-800/20 rounded-lg md:rounded-xl border border-green-200 dark:border-green-700",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-green-700 dark:text-green-400 font-medium mb-1 sm:mb-2",children:"أيام العمل المتاحة"}),e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-1.5 md:gap-2",children:l.workDays.days.length>0?l.workDays.days.map((h,c)=>e.jsx("span",{className:"px-2 py-0.5 md:px-3 md:py-1 bg-green-500 text-white text-[10px] md:text-xs font-medium rounded-full shadow-sm",children:h},c)):e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs md:text-sm",children:"لا توجد أيام عمل محددة"})})]})})]}),e.jsxs(y,{onClick:()=>s("schedule"),className:"w-full md:w-auto text-sm",section:"hospital",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"إدارة أيام العمل"]})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-8",children:e.jsxs(v,{className:"hover:shadow-lg transition-shadow duration-300 border-r-4 border-r-blue-500",children:[e.jsxs(_,{className:"pb-3 md:pb-4",children:[e.jsxs(L,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(z,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600"}),"إحصائيات جدول الخدمات"]}),e.jsx(I,{className:"text-xs md:text-sm",children:"الخدمات الطبية المتاحة في المستشفى"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 md:gap-4",children:[e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 rounded-lg md:rounded-xl border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-blue-700 dark:text-blue-400 font-medium mb-0.5 sm:mb-1",children:"إجمالي الخدمات"}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-blue-900 dark:text-blue-100",children:l.services.total})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-blue-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(z,{className:"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 text-blue-600"})})]})}),e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-900/30 dark:to-cyan-800/20 rounded-lg md:rounded-xl border border-cyan-200 dark:border-cyan-700",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-cyan-700 dark:text-cyan-400 font-medium mb-0.5 sm:mb-1",children:"متوسط السعر"}),e.jsxs("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-cyan-900 dark:text-cyan-100 truncate",children:[l.services.averagePrice.toFixed(2)," ل.س"]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-cyan-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-base sm:text-lg md:text-xl lg:text-2xl",children:"💰"})})]})}),e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/30 dark:to-indigo-800/20 rounded-lg md:rounded-xl border border-indigo-200 dark:border-indigo-700",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-indigo-700 dark:text-indigo-400 font-medium mb-0.5 sm:mb-1",children:"السعة الإجمالية"}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-indigo-900 dark:text-indigo-100",children:l.services.totalCapacity})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-indigo-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-base sm:text-lg md:text-xl lg:text-2xl",children:"📊"})})]})})]}),e.jsxs(y,{onClick:()=>s("services"),className:"w-full md:w-auto text-sm",section:"services",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"إدارة الخدمات"]})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:gap-8",children:e.jsxs(v,{className:"hover:shadow-lg transition-shadow duration-300 border-r-4 border-r-purple-500",children:[e.jsxs(_,{className:"pb-3 md:pb-4",children:[e.jsxs(L,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(S,{className:"w-5 h-5 md:w-6 md:h-6 text-purple-600"}),"إحصائيات جدول الحجوزات"]}),e.jsx(I,{className:"text-xs md:text-sm",children:"حالة وتفاصيل حجوزات المرضى"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1.5 sm:gap-2 md:gap-4",children:[e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-purple-200 dark:border-purple-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-purple-700 dark:text-purple-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"إجمالي الحجوزات"}),e.jsx("p",{className:"text-base xs:text-lg sm:text-xl md:text-3xl font-bold text-purple-900 dark:text-purple-100",children:l.reservations.total})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/30 dark:to-yellow-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-yellow-200 dark:border-yellow-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-yellow-700 dark:text-yellow-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"قيد الانتظار"}),e.jsx("p",{className:"text-base xs:text-lg sm:text-xl md:text-3xl font-bold text-yellow-900 dark:text-yellow-100",children:l.reservations.pending})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-green-200 dark:border-green-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-green-700 dark:text-green-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"مؤكدة"}),e.jsx("p",{className:"text-base xs:text-lg sm:text-xl md:text-3xl font-bold text-green-900 dark:text-green-100",children:l.reservations.confirmed})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-red-200 dark:border-red-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-red-700 dark:text-red-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"ملغاة"}),e.jsx("p",{className:"text-base xs:text-lg sm:text-xl md:text-3xl font-bold text-red-900 dark:text-red-100",children:l.reservations.cancelled})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1.5 sm:gap-2 md:gap-4",children:[e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-teal-50 to-teal-100 dark:from-teal-900/30 dark:to-teal-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-teal-200 dark:border-teal-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-teal-700 dark:text-teal-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"مكتملة"}),e.jsx("p",{className:"text-sm xs:text-base sm:text-lg md:text-2xl font-bold text-teal-900 dark:text-teal-100",children:l.reservations.completed})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-blue-700 dark:text-blue-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"حجوزات اليوم"}),e.jsx("p",{className:"text-sm xs:text-base sm:text-lg md:text-2xl font-bold text-blue-900 dark:text-blue-100",children:l.reservations.today})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/30 dark:to-indigo-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-indigo-200 dark:border-indigo-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-indigo-700 dark:text-indigo-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"هذا الأسبوع"}),e.jsx("p",{className:"text-sm xs:text-base sm:text-lg md:text-2xl font-bold text-indigo-900 dark:text-indigo-100",children:l.reservations.thisWeek})]})}),e.jsx("div",{className:"p-2 sm:p-3 md:p-4 bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/30 dark:to-pink-800/20 rounded-md sm:rounded-lg md:rounded-xl border border-pink-200 dark:border-pink-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] xs:text-[10px] sm:text-xs md:text-sm text-pink-700 dark:text-pink-400 font-medium mb-0.5 md:mb-1 leading-tight",children:"هذا الشهر"}),e.jsx("p",{className:"text-sm xs:text-base sm:text-lg md:text-2xl font-bold text-pink-900 dark:text-pink-100",children:l.reservations.thisMonth})]})})]}),e.jsx("div",{className:"p-3 sm:p-4 md:p-6 bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/30 dark:to-emerald-800/20 rounded-lg md:rounded-xl border-2 border-emerald-300 dark:border-emerald-700",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-emerald-700 dark:text-emerald-400 font-medium mb-0.5 sm:mb-1",children:"إجمالي الإيرادات"}),e.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl font-bold text-emerald-900 dark:text-emerald-100 truncate",children:[l.reservations.revenue.toFixed(2)," ل.س"]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 bg-emerald-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl",children:"💵"})})]})}),e.jsxs(y,{onClick:()=>s("reservations"),className:"w-full md:w-auto text-sm",section:"services",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"عرض جميع الحجوزات"]})]})})]})})]})]})},q=({isOpen:s,onClose:t,onConfirm:l,title:g,description:x,confirmText:o="تأكيد",cancelText:a="إلغاء",type:i="warning",loading:u=!1})=>{if(!s)return null;const h=()=>{switch(i){case"danger":return e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});case"warning":return e.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});case"info":return e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}},c=()=>i==="danger"?"destructive":"default";return e.jsx("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 flex items-center justify-center z-[100] p-4 animate-in fade-in duration-200",onClick:t,children:e.jsxs(v,{className:"w-full max-w-md dark:bg-gray-800 shadow-2xl animate-in zoom-in-95 duration-200",onClick:j=>j.stopPropagation(),children:[e.jsxs(_,{className:"text-center pb-3",children:[h(),e.jsx(L,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:g}),e.jsx(I,{className:"text-base mt-2 text-gray-600 dark:text-gray-400",children:x})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(y,{onClick:t,variant:"outline",className:"flex-1",disabled:u,children:a}),e.jsx(y,{onClick:l,variant:c(),className:"flex-1",disabled:u,children:u?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري المعالجة..."]}):o})]})})]})})},Me=()=>{const[s,t]=m.useState([]),[l,g]=m.useState(!0),[x,o]=m.useState(null),[a,i]=m.useState({isOpen:!1,type:"confirm",reservationId:null}),u=m.useCallback(async()=>{g(!0),o(null);try{const d=await _e();t(d)}catch{o("فشل في جلب الحجوزات. تحقق من اتصال الخادم.")}finally{g(!1)}},[]);m.useEffect(()=>{u()},[u]);const h=d=>{i({isOpen:!0,type:"confirm",reservationId:d})},c=d=>{i({isOpen:!0,type:"cancel",reservationId:d})},j=async()=>{if(!a.reservationId)return;const d=b.loading(a.type==="confirm"?"جاري تأكيد الحجز...":"جاري إلغاء الحجز...");try{a.type==="confirm"?(await Le(a.reservationId),b.dismiss(d),b.success("تم تأكيد الحجز بنجاح")):(await Te(a.reservationId),b.dismiss(d),b.success("تم إلغاء الحجز بنجاح")),u()}catch(w){b.dismiss(d),b.error(`فشل في ${a.type==="confirm"?"تأكيد":"إلغاء"} الحجز: ${w.message}`)}finally{i({isOpen:!1,type:"confirm",reservationId:null})}};return e.jsxs("div",{className:"space-y-6",children:[x&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400 dark:text-red-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:x}),e.jsx("button",{onClick:u,className:"text-sm text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300 underline",children:"إعادة المحاولة"})]})]})}),e.jsxs(v,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-purple-600"}),"الحجوزات قيد الانتظار"]}),e.jsx(I,{children:"عرض وإدارة الحجوزات التي تحتاج إلى مراجعة"})]}),e.jsxs(y,{onClick:u,disabled:l,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600"}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"تحديث"]})]})}),e.jsx(k,{children:l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحميل..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden space-y-4",children:s.map(d=>e.jsx(v,{className:"border-r-4 border-r-purple-500",children:e.jsxs(k,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(F,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"المريض"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:d.user_name})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"الخدمة"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:d.service_name}),e.jsxs("p",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:[d.price," ل.س"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(M,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"الفترة"}),e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["من: ",new Date(d.start_date).toLocaleDateString("ar-EG",{month:"short",day:"numeric"})]}),e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["إلى: ",new Date(d.end_date).toLocaleDateString("ar-EG",{month:"short",day:"numeric"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(y,{onClick:()=>h(d.id),section:"services",size:"sm",className:"flex-1 text-xs",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"تأكيد"]}),e.jsxs(y,{onClick:()=>c(d.id),variant:"outline",size:"sm",className:"flex-1 text-xs text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"إلغاء"]})]})]})},d.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-full border-collapse border border-gray-200 dark:border-gray-700",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"اسم المريض"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"الخدمة"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"السعر (ل.س)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"تاريخ البداية"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"تاريخ النهاية"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-center font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"الإجراءات"})]})}),e.jsxs("tbody",{children:[s.map(d=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-900 dark:text-gray-100 font-medium text-sm",children:d.user_name}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-700 dark:text-gray-300 text-sm",children:d.service_name}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-blue-600 dark:text-blue-400 font-semibold text-sm",children:d.price}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-700 dark:text-gray-300 text-sm",children:new Date(d.start_date).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-700 dark:text-gray-300 text-sm",children:new Date(d.end_date).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs(y,{onClick:()=>h(d.id),section:"services",size:"sm",className:"text-xs",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"تأكيد"]}),e.jsxs(y,{onClick:()=>c(d.id),variant:"outline",size:"sm",className:"text-xs text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"إلغاء"]})]})})]},d.id)),s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"border border-gray-200 dark:border-gray-700 px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(B,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{children:"لا توجد حجوزات قيد الانتظار."})]})})]})]})}),s.length===0&&e.jsxs("div",{className:"block md:hidden text-center p-8",children:[e.jsx(B,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"لا توجد حجوزات قيد الانتظار."})]})]})})]}),e.jsx(q,{isOpen:a.isOpen,onClose:()=>i({isOpen:!1,type:"confirm",reservationId:null}),onConfirm:j,title:a.type==="confirm"?"تأكيد الحجز":"إلغاء الحجز",description:a.type==="confirm"?"هل أنت متأكد من تأكيد هذا الحجز؟":"هل أنت متأكد من إلغاء هذا الحجز؟ لن تتمكن من التراجع عن هذا الإجراء.",confirmText:a.type==="confirm"?"تأكيد":"إلغاء الحجز",cancelText:"إلغاء",type:a.type==="confirm"?"success":"danger"})]})},Ae=()=>{const[s,t]=m.useState([]),[l,g]=m.useState(!0),[x,o]=m.useState(null),[a,i]=m.useState("all"),[u,h]=m.useState(""),[c,j]=m.useState(""),[d,w]=m.useState(""),[r,N]=m.useState("date"),p=m.useCallback(async()=>{g(!0),o(null);try{const D=(await G()).filter(A=>A.status==="confirmed"||A.status==="cancelled");t(D)}catch{o("فشل في جلب سجل الحجوزات. تحقق من اتصال الخادم.")}finally{g(!1)}},[]);m.useEffect(()=>{p()},[p]);const C=n=>{switch(n){case"confirmed":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300";case"cancelled":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300";default:return"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"}},T=n=>{switch(n){case"confirmed":return"مؤكد";case"cancelled":return"ملغي";default:return n}},f=n=>{switch(n){case"confirmed":return e.jsx($,{className:"w-4 h-4"});case"cancelled":return e.jsx(P,{className:"w-4 h-4"});default:return e.jsx(B,{className:"w-4 h-4"})}},E=s.filter(n=>{if(a!=="all"&&n.status!==a)return!1;if(u){const D=u.toLowerCase(),A=n.user_name.toLowerCase().includes(D),se=n.service_name.toLowerCase().includes(D);if(!A&&!se)return!1}return!(c&&n.start_date<c||d&&n.start_date>d)}).sort((n,D)=>{switch(r){case"date":return new Date(D.start_date).getTime()-new Date(n.start_date).getTime();case"price":return D.price-n.price;case"status":return n.status.localeCompare(D.status);default:return 0}}),J=s.filter(n=>n.status==="confirmed").length,Z=s.filter(n=>n.status==="cancelled").length,ee=s.filter(n=>n.status==="confirmed").reduce((n,D)=>n+D.price,0);return e.jsxs("div",{className:"space-y-6",children:[x&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400 dark:text-red-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:x}),e.jsx("button",{onClick:p,className:"text-sm text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300 underline",children:"إعادة المحاولة"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(v,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-green-200 dark:border-green-800",children:e.jsx(k,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-green-600 dark:text-green-400",children:"الحجوزات المؤكدة"}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-green-700 dark:text-green-300 mt-1 sm:mt-2",children:J})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-200 dark:bg-green-800/50 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx($,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600 dark:text-green-400"})})]})})}),e.jsx(v,{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 border-red-200 dark:border-red-800",children:e.jsx(k,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-red-600 dark:text-red-400",children:"الحجوزات الملغاة"}),e.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-red-700 dark:text-red-300 mt-1 sm:mt-2",children:Z})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-200 dark:bg-red-800/50 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(P,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600 dark:text-red-400"})})]})})}),e.jsx(v,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 border-blue-200 dark:border-blue-800",children:e.jsx(k,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-600 dark:text-blue-400",children:"إجمالي الإيرادات"}),e.jsxs("p",{className:"text-base sm:text-xl md:text-2xl lg:text-3xl font-bold text-blue-700 dark:text-blue-300 mt-1 sm:mt-2 truncate",children:[ee.toFixed(0)," ل.س"]})]}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-200 dark:bg-blue-800/50 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})})]}),e.jsxs(v,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-indigo-600"}),"سجل الحجوزات"]}),e.jsx(I,{children:"عرض جميع الحجوزات المؤكدة والملغاة"})]}),e.jsxs(y,{onClick:p,disabled:l,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600"}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"تحديث"]})]})}),e.jsxs(k,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:[{key:"all",label:"جميع السجلات",icon:"📊"},{key:"confirmed",label:"المؤكدة",icon:"✅"},{key:"cancelled",label:"الملغاة",icon:"❌"}].map(({key:n,label:D,icon:A})=>e.jsxs(y,{variant:a===n?"default":"outline",size:"sm",onClick:()=>i(n),className:a===n?"bg-indigo-600 hover:bg-indigo-700":"",children:[e.jsx("span",{className:"ml-2",children:A}),D]},n))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"بحث"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"اسم المريض أو الخدمة...",value:u,onChange:n=>h(n.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),e.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"من تاريخ"}),e.jsx("input",{type:"date",value:c,onChange:n=>j(n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"إلى تاريخ"}),e.jsx("input",{type:"date",value:d,onChange:n=>w(n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"ترتيب حسب"}),e.jsxs("select",{value:r,onChange:n=>N(n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"date",children:"التاريخ (الأحدث أولاً)"}),e.jsx("option",{value:"price",children:"السعر (الأعلى أولاً)"}),e.jsx("option",{value:"status",children:"الحالة"})]})]})]}),(u||c||d||a!=="all")&&e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["عدد النتائج: ",e.jsx("span",{className:"font-semibold text-indigo-600",children:E.length})," من أصل ",s.length]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>{h(""),j(""),w(""),i("all"),N("date")},className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"مسح الفلاتر"]})]}),l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحميل..."})]})}):e.jsxs("div",{className:"space-y-4",children:[E.map(n=>e.jsx(v,{className:"hover:shadow-lg transition-shadow duration-300",children:e.jsx(k,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"المريض"})]}),e.jsx("div",{className:"pl-6",children:e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:n.user_name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"الخدمة"})]}),e.jsxs("div",{className:"pl-6",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:n.service_name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n.price," ل.س"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"التاريخ"})]}),e.jsxs("div",{className:"pl-6",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:["من: ",new Date(n.start_date).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["إلى: ",new Date(n.end_date).toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"الحالة"})]}),e.jsx("div",{className:"pl-6",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium ${C(n.status)}`,children:[f(n.status),T(n.status)]})})]})]})})},n.id)),E.length===0&&e.jsxs("div",{className:"text-center p-8",children:[e.jsx(S,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"لا توجد سجلات"})]})]})]})]})]})},H=({onEdit:s,onDelete:t,showEdit:l=!0,showDelete:g=!0,size:x="sm",disabled:o=!1})=>{const a={sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"},i={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[l&&s&&e.jsxs("button",{onClick:s,disabled:o,title:"تعديل",className:`
            ${a[x]}
            relative group overflow-hidden
            bg-gradient-to-br from-blue-500 to-blue-600
            hover:from-blue-600 hover:to-blue-700
            dark:from-blue-600 dark:to-blue-700
            dark:hover:from-blue-700 dark:hover:to-blue-800
            text-white font-semibold rounded-full
            shadow-lg hover:shadow-xl hover:shadow-blue-500/50
            transform hover:-translate-y-1 hover:scale-110
            transition-all duration-300
            disabled:opacity-50 disabled:cursor-not-allowed
            disabled:transform-none disabled:hover:shadow-lg
            flex items-center justify-center
            border-2 border-blue-400/30
          `,children:[e.jsx("span",{className:"absolute inset-0 rounded-full bg-white/20 opacity-0 group-hover:opacity-100 group-hover:animate-ping"}),e.jsx("span",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-white/0 via-white/30 to-white/0 opacity-0 group-hover:opacity-100 group-hover:animate-spin"}),e.jsx("svg",{className:`${i[x]} relative z-10 group-hover:rotate-12 transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),g&&t&&e.jsxs("button",{onClick:t,disabled:o,title:"حذف",className:`
            ${a[x]}
            relative group overflow-hidden
            bg-gradient-to-br from-red-500 to-rose-600
            hover:from-red-600 hover:to-rose-700
            dark:from-red-600 dark:to-rose-700
            dark:hover:from-red-700 dark:hover:to-rose-800
            text-white font-semibold rounded-full
            shadow-lg hover:shadow-xl hover:shadow-red-500/50
            transform hover:-translate-y-1 hover:scale-110
            transition-all duration-300
            disabled:opacity-50 disabled:cursor-not-allowed
            disabled:transform-none disabled:hover:shadow-lg
            flex items-center justify-center
            border-2 border-red-400/30
          `,children:[e.jsx("span",{className:"absolute inset-0 rounded-full bg-white/20 opacity-0 group-hover:opacity-100 group-hover:animate-ping"}),e.jsx("span",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-white/0 via-white/30 to-white/0 opacity-0 group-hover:opacity-100 group-hover:animate-pulse"}),e.jsx("svg",{className:`${i[x]} relative z-10 group-hover:scale-110 transition-transform duration-300`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})]})]})},Oe=({hospital:s,account:t,refreshData:l})=>{const[g,x]=m.useState(!1),[o,a]=m.useState(!1),i=async u=>{u.preventDefault(),a(!0);const h=new FormData(u.currentTarget);try{await he(h),b.success("تم تحديث الملف الشخصي بنجاح"),x(!1),l()}catch(c){b.error(`خطأ: ${c.message}`)}finally{a(!1)}};return!s||!t?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 dark:border-teal-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري تحميل بيانات الملف الشخصي..."})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(v,{children:[e.jsxs(_,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-teal-600"}),"الملف الشخصي للمستشفى"]}),e.jsx(I,{children:"عرض وتعديل معلومات المستشفى الأساسية"})]}),e.jsx(k,{children:g?e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(O,{label:"اسم المستشفى",name:"full_name",defaultValue:s.full_name,required:!0}),e.jsx(O,{label:"العنوان",name:"address",defaultValue:s.address,required:!0}),e.jsx(O,{label:"رقم الهاتف",name:"phone_number",defaultValue:t.phone_number,required:!0})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(y,{type:"submit",disabled:o,section:"hospital",children:o?"جاري الحفظ...":"حفظ التغييرات"}),e.jsx(y,{type:"button",onClick:()=>x(!1),variant:"outline",children:"إلغاء"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:"اسم المستشفى"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:s.full_name})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:"العنوان"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:s.address})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:"البريد الإلكتروني"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t.email})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:"رقم الهاتف"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t.phone_number})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:"الحالة"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${t.is_approved==="approved"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300"}`,children:t.is_approved==="approved"?"مقبول":"قيد الانتظار"})]}),e.jsxs(y,{onClick:()=>x(!0),section:"hospital",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"تعديل الملف الشخصي"]})]})]})})]})})},ze=()=>{const[s,t]=m.useState([]),[l,g]=m.useState(!0),[x,o]=m.useState(!1),[a,i]=m.useState(null),[u,h]=m.useState({isOpen:!1,serviceId:null}),c=m.useCallback(async()=>{g(!0);try{const r=await ne();t(r)}catch(r){console.error(r),b.error("فشل في جلب الخدمات")}finally{g(!1)}},[]);m.useEffect(()=>{c()},[c]);const j=r=>{h({isOpen:!0,serviceId:r})},d=async()=>{if(!u.serviceId)return;const r=b.loading("جاري حذف الخدمة...");try{await me(u.serviceId),b.dismiss(r),b.success("تم حذف الخدمة بنجاح"),c()}catch{b.dismiss(r),b.error("فشل في حذف الخدمة")}finally{h({isOpen:!1,serviceId:null})}},w=async r=>{r.preventDefault();const N=new FormData(r.currentTarget),p=N.get("price"),C=N.get("capacity"),T=b.loading(a?"جاري تحديث الخدمة...":"جاري إضافة الخدمة...");try{a?p&&C&&await oe(a.id,Number(p),Number(C)):await xe(N),b.dismiss(T),b.success(a?"تم تحديث الخدمة بنجاح":"تم إضافة الخدمة بنجاح"),c(),o(!1),i(null)}catch(f){b.dismiss(T),b.error(`فشل في حفظ الخدمة: ${f.message}`)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600"}),"إدارة الخدمات الطبية"]}),e.jsx(I,{children:"إضافة وتعديل الخدمات والأسعار والمواعيد"})]}),e.jsxs(y,{onClick:()=>{i(null),o(!0)},section:"services",className:"text-xs sm:text-sm px-2 sm:px-4 h-8 sm:h-10",children:[e.jsx(Q,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden xs:inline",children:"إضافة خدمة جديدة"}),e.jsx("span",{className:"xs:hidden",children:"إضافة"})]})]})}),e.jsx(k,{children:l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 dark:border-blue-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحميل..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"block md:hidden space-y-3",children:[s.map(r=>e.jsx(v,{className:"border-r-4 border-r-blue-500",children:e.jsxs(k,{className:"p-3 space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm mb-1 truncate",children:r.service_name}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:["💰 ",r.price," ل.س"]}),e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["👥 ",r.capacity," مريض"]})]})]})}),e.jsx("div",{className:"flex gap-2 pt-2",children:e.jsx(H,{onEdit:()=>{i(r),o(!0)},onDelete:()=>j(r.id),size:"sm"})})]})},r.id)),s.length===0&&e.jsxs("div",{className:"text-center p-8",children:[e.jsx(U,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"لم تتم إضافة خدمات بعد."})]})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-full border-collapse border border-gray-200 dark:border-gray-700",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"اسم الخدمة"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"السعر (ل.س)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"السعة (مريض)"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-center font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"الإجراءات"})]})}),e.jsxs("tbody",{children:[s.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-900 dark:text-gray-100 font-medium text-sm",children:r.service_name}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-blue-600 dark:text-blue-400 font-semibold text-sm",children:r.price}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-gray-700 dark:text-gray-300 text-sm",children:r.capacity}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3",children:e.jsx(H,{onEdit:()=>{i(r),o(!0)},onDelete:()=>j(r.id),size:"sm"})})]},r.id)),s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"border border-gray-200 dark:border-gray-700 px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(U,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{children:"لم تتم إضافة خدمات بعد."})]})})]})]})})]})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs(v,{className:"w-full max-w-md dark:bg-gray-800",children:[e.jsx(_,{children:e.jsx(L,{children:a?"تعديل الخدمة":"إضافة خدمة جديدة"})}),e.jsx(k,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!a&&e.jsx(O,{label:"اسم الخدمة",name:"service_name",required:!0}),e.jsx(O,{label:"السعر (ل.س)",name:"price",type:"number",defaultValue:a==null?void 0:a.price,required:!0}),e.jsx(O,{label:"السعة (عدد المرضى)",name:"capacity",type:"number",defaultValue:a==null?void 0:a.capacity,required:!0}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(y,{type:"button",onClick:()=>o(!1),variant:"outline",children:"إلغاء"}),e.jsx(y,{type:"submit",section:"services",children:"حفظ"})]})]})})]})}),e.jsx(q,{isOpen:u.isOpen,onClose:()=>h({isOpen:!1,serviceId:null}),onConfirm:d,title:"تأكيد حذف الخدمة",description:"هل أنت متأكد من حذف هذه الخدمة؟ لن تتمكن من التراجع عن هذا الإجراء.",confirmText:"حذف",cancelText:"إلغاء",type:"danger"})]})},$e=()=>{const[s,t]=m.useState([]),[l,g]=m.useState(!0),[x,o]=m.useState(null),[a,i]=m.useState({isOpen:!1,dayId:null}),u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h={Sunday:"الأحد",Monday:"الاثنين",Tuesday:"الثلاثاء",Wednesday:"الأربعاء",Thursday:"الخميس",Friday:"الجمعة",Saturday:"السبت"},c=m.useCallback(async()=>{g(!0),o(null);try{const r=await de();t(r)}catch(r){console.error("Error fetching schedules:",r),o("فشل في جلب جدول العمل. تأكد من اتصال الخادم."),t([])}finally{g(!1)}},[]);m.useEffect(()=>{c()},[c]);const j=async r=>{r.preventDefault();const p=new FormData(r.currentTarget).get("day_of_week");if(s.find(T=>T.day_of_week.toLowerCase()===p.toLowerCase())){b.warning("هذا اليوم مضاف بالفعل.");return}const C=b.loading("جاري إضافة اليوم...");try{await ie(p),b.dismiss(C),b.success("تم إضافة اليوم بنجاح"),c(),r.target.reset()}catch(T){b.dismiss(C),b.error(`فشل في إضافة اليوم: ${T.message}`)}},d=r=>{i({isOpen:!0,dayId:r})},w=async()=>{if(!a.dayId)return;const r=b.loading("جاري حذف اليوم...");try{await ce(a.dayId),b.dismiss(r),b.success("تم حذف اليوم بنجاح"),c()}catch(N){b.dismiss(r),b.error(`فشل في حذف اليوم: ${N.message}`)}finally{i({isOpen:!1,dayId:null})}};return e.jsxs("div",{className:"space-y-6",children:[x&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400 dark:text-red-300",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:x}),e.jsx("button",{onClick:c,className:"text-sm text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300 underline",children:"إعادة المحاولة"})]})]})}),e.jsxs(v,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-green-600"}),"إضافة يوم عمل جديد"]}),e.jsx(I,{children:"اختر الأيام التي يعمل فيها المستشفى"})]}),e.jsxs(y,{onClick:c,disabled:l,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"تحديث"]})]})}),e.jsx(k,{children:e.jsx("form",{onSubmit:j,className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"day_of_week",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"اختر يوماً"}),e.jsx("select",{name:"day_of_week",id:"day_of_week",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 dark:text-black",children:u.map(r=>e.jsx("option",{value:r,children:h[r]},r))})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(y,{type:"submit",section:"hospital",className:"w-full md:w-auto text-xs sm:text-sm px-2 sm:px-4 h-8 sm:h-10",children:[e.jsx(Q,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),"إضافة اليوم"]})})]})})})]}),e.jsxs(v,{children:[e.jsxs(_,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-green-600"}),"أيام العمل الحالية"]}),e.jsx(I,{children:"الأيام المحددة للعمل في المستشفى"})]}),e.jsx(k,{children:l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 dark:border-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"جاري التحميل..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"block md:hidden space-y-3",children:[s.map(r=>e.jsx(v,{className:"border-r-4 border-r-green-500",children:e.jsx(k,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:h[r.day_of_week.charAt(0).toUpperCase()+r.day_of_week.slice(1)]||r.day_of_week})]}),e.jsx(H,{onDelete:()=>d(r.id),showEdit:!1,size:"sm"})]})})},r.id)),s.length===0&&e.jsxs("div",{className:"text-center p-8",children:[e.jsx(S,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"لم تتم إضافة أيام عمل بعد."})]})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-full border-collapse border border-gray-200 dark:border-gray-700",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"يوم العمل"}),e.jsx("th",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3 text-center font-semibold text-gray-700 dark:text-gray-300 text-sm",children:"الإجراءات"})]})}),e.jsxs("tbody",{children:[s.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-100 text-sm",children:h[r.day_of_week.charAt(0).toUpperCase()+r.day_of_week.slice(1)]||r.day_of_week})]})}),e.jsx("td",{className:"border border-gray-200 dark:border-gray-700 px-4 py-3",children:e.jsx(H,{onDelete:()=>d(r.id),showEdit:!1,size:"sm"})})]},r.id)),s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:2,className:"border border-gray-200 dark:border-gray-700 px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(S,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{children:"لم تتم إضافة أيام عمل بعد."})]})})]})]})})]})})]}),e.jsx(q,{isOpen:a.isOpen,onClose:()=>i({isOpen:!1,dayId:null}),onConfirm:w,title:"تأكيد حذف يوم العمل",description:"هل أنت متأكد من حذف هذا اليوم من جدول العمل؟",confirmText:"حذف",cancelText:"إلغاء",type:"danger"})]})},He=({onLogout:s})=>{var N;const[t,l]=m.useState("overview"),[g,x]=m.useState({hospital:null,account:null}),[o,a]=m.useState(!0),[i,u]=m.useState(!1),h=m.useCallback(async()=>{a(!0);try{const[p,C]=await ae();x({account:p,hospital:C})}catch(p){console.error("Failed to fetch profile",p),s()}finally{a(!1)}},[s]);m.useEffect(()=>{h()},[h]);const c=async()=>{try{await le()}catch(p){console.error("Logout failed on server, logging out client-side.",p)}finally{s()}},j=p=>{(p==="overview"||p==="profile"||p==="services"||p==="schedule"||p==="reservations"||p==="history")&&l(p)},d=()=>{var p,C;switch(t){case"overview":return e.jsx(Y,{onNavigate:j,userFullName:(p=g.hospital)==null?void 0:p.full_name});case"profile":return e.jsx(Oe,{hospital:g.hospital,account:g.account,refreshData:h});case"services":return e.jsx(ze,{});case"schedule":return e.jsx($e,{});case"reservations":return e.jsx(Me,{});case"history":return e.jsx(Ae,{});default:return e.jsx(Y,{onNavigate:j,userFullName:(C=g.hospital)==null?void 0:C.full_name})}},r=(()=>{switch(t){case"overview":return null;case"profile":return{title:"الملف الشخصي للمستشفى",description:"عرض وتعديل معلومات المستشفى الأساسية",icon:"👤",color:"from-teal-500 to-cyan-600"};case"services":return{title:"إدارة الخدمات الطبية",description:"إدارة الخدمات والأسعار والمواعيد",icon:"🏥",color:"from-blue-500 to-cyan-600"};case"schedule":return{title:"جدول أيام العمل",description:"إدارة أوقات العمل الأسبوعية",icon:"📅",color:"from-green-500 to-emerald-600"};case"reservations":return{title:"الحجوزات قيد الانتظار",description:"عرض وإدارة الحجوزات التي تحتاج إلى مراجعة",icon:"⏳",color:"from-purple-500 to-indigo-600"};case"history":return{title:"سجل الحجوزات",description:"عرض جميع الحجوزات المؤكدة والملغاة",icon:"📜",color:"from-indigo-500 to-purple-600"};default:return null}})();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col overflow-x-hidden transition-colors duration-200",children:[e.jsx(Ne,{onLogout:c,onMenuClick:()=>u(!0),userFullName:(N=g.hospital)==null?void 0:N.full_name,activeTab:t,onTabChange:j}),e.jsx(we,{isOpen:i,onClose:()=>u(!1),activeTab:t,onTabChange:p=>{l(p)}}),e.jsx("div",{className:"flex-1 flex flex-col pt-16",children:e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-gray-50 dark:bg-gray-900",children:[r&&e.jsx("div",{className:`bg-gradient-to-r ${r.color} text-white shadow-lg w-full`,children:e.jsx("div",{className:"px-2 sm:px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("div",{className:"text-2xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base sm:text-lg font-bold",children:r.title}),e.jsx("p",{className:"mt-1 text-xs sm:text-sm opacity-90",children:r.description})]})]})})}),e.jsx("div",{className:"w-full max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-6 flex-1 flex flex-col overflow-x-hidden",children:d()})]})})]})};export{He as default};
